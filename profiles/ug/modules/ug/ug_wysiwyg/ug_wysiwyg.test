<?php

/**
 * @file
 * Tests for ug_wysiwyg.module.
 */

/**
 * Test UG Wysiwyg feature.
 */
class UGWysiwygTestCase extends DrupalWebTestCase {

  public static function getInfo() {
    return array(
      'name' => 'UG Wysiwyg',
      'description' => 'Test the UG Wysiwyg feature.',
      'group' => 'UG',
    );
  }

  function setUp() {
    $this->profile = 'ug';
    parent::setup('ug_wysiwyg');
  }

  /**
   * Test filtered HTML.
   *
   * Valid HTML5 is allowed, except for:
   *   - document metadata,
   *   - forms,
   *   - scripting,
   *   - body, iframe, embed, object, param, map, and area elements, and
   *   - id attributes.
   * Bootstrap 3.0.2 CSS classes are allowed.
   */
  function testFilteredHTML() {
    $global_attributes = 'accesskey class contenteditable dir hidden id lang spellcheck style tabindex title translate';
    $allowed_global_attributes = array(
      'accesskey' => TRUE,
      'class' => TRUE,
      'contenteditable' => TRUE,
      'dir' => TRUE,
      'hidden' => TRUE,
      'id=' => FALSE,
      'lang' => TRUE,
      'spellcheck' => TRUE,
      'style' => TRUE,
      'tabindex' => TRUE,
      'title' => TRUE,
      'translate' => TRUE,
    );
    $filter = 'filtered_html';
    $tests = array(
      /* Document metadata */
      "<html />" => array('html' => FALSE),
      "<title />" => array('title' => FALSE),
      "<base />" => array('base' => FALSE),
      "<link />" => array('link' => FALSE),
      "<meta />" => array('meta' => FALSE),
      "<style />" => array('style' => FALSE),

      /* Sections */
      "<body />" => array('body' => FALSE),
      "<article $global_attributes />" => array(
        'article' => TRUE,
      ) + $allowed_global_attributes,
      "<section $global_attributes />" => array(
        'section' => TRUE,
      ) + $allowed_global_attributes,
      "<nav $global_attributes />" => array(
        'nav' => TRUE,
      ) + $allowed_global_attributes,
      "<aside $global_attributes />" => array(
        'aside' => TRUE,
      ) + $allowed_global_attributes,
      "<h1 $global_attributes />" => array('h1' => TRUE) + $allowed_global_attributes,
      "<h2 $global_attributes />" => array('h2' => TRUE) + $allowed_global_attributes,
      "<h3 $global_attributes />" => array('h3' => TRUE) + $allowed_global_attributes,
      "<h4 $global_attributes />" => array('h4' => TRUE) + $allowed_global_attributes,
      "<h5 $global_attributes />" => array('h5' => TRUE) + $allowed_global_attributes,
      "<h6 $global_attributes />" => array('h6' => TRUE) + $allowed_global_attributes,
      "<header $global_attributes />" => array(
        'header' => TRUE,
      ) + $allowed_global_attributes,
      "<footer $global_attributes />" => array(
        'footer' => TRUE,
      ) + $allowed_global_attributes,
      "<address $global_attributes />" => array(
        'address' => TRUE,
      ) + $allowed_global_attributes,

      /* Grouping content */
      "<p $global_attributes />" => array(
        'p' => TRUE
      ) + $allowed_global_attributes,
      "<hr $global_attributes />" => array(
        'hr' => TRUE
      ) + $allowed_global_attributes,
      "<pre $global_attributes />" => array(
        'pre' => TRUE
      ) + $allowed_global_attributes,
      "<blockquote $global_attributes cite />" => array(
        'blockquote' => TRUE,
        'cite' => TRUE,
      ) + $allowed_global_attributes,
      "<ol $global_attributes reversed start type />" => array(
        'ol' => TRUE,
        'reversed' => TRUE,
        'start' => TRUE,
        'type' => TRUE,
      ) + $allowed_global_attributes,
      "<ul $global_attributes />" => array(
        'ul' => TRUE,
      ) + $allowed_global_attributes,
      "<li $global_attributes value />" => array(
        'li' => TRUE,
        'value' => TRUE,
      ) + $allowed_global_attributes,
      "<dl $global_attributes />" => array('dl' => TRUE,
      ),
      "<dt $global_attributes />" => array('dt' => TRUE) + $allowed_global_attributes,
      "<dd $global_attributes />" => array('dd' => TRUE) + $allowed_global_attributes,
      "<figure $global_attributes />" => array('figure' => TRUE) + $allowed_global_attributes,
      "<figcaption $global_attributes />" => array('figcaption' => TRUE) + $allowed_global_attributes,
      "<div $global_attributes />" => array('div' => TRUE) + $allowed_global_attributes,
      "<main $global_attributes />" => array('main' => FALSE),

      /* Text-level semantics */
      "<a $global_attributes href target download rel hreflang type id />" => array(
        'a' => TRUE,
        'href' => TRUE,
        'target' => TRUE,
        'download' => TRUE,
        'rel' => TRUE,
        'hreflang' => TRUE,
        'type' => TRUE,
        'id' => TRUE,
      ) + $this->allow_id($allowed_global_attributes),
      "<em $global_attributes />" => array('em' => TRUE) + $allowed_global_attributes,
      "<strong $global_attributes />" => array('strong' => TRUE) + $allowed_global_attributes,
      "<small $global_attributes />" => array('small' => TRUE) + $allowed_global_attributes,
      "<s $global_attributes />" => array('s' => TRUE) + $allowed_global_attributes,
      "<cite $global_attributes />" => array('cite' => TRUE) + $allowed_global_attributes,
      "<q $global_attributes />" => array('q' => TRUE) + $allowed_global_attributes,
      "<dfn $global_attributes />" => array('dfn' => TRUE) + $allowed_global_attributes,
      "<abbr $global_attributes />" => array('abbr' => TRUE) + $allowed_global_attributes,
      "<data $global_attributes value />" => array('data' => TRUE, 'value' => TRUE) + $allowed_global_attributes,
      "<time $global_attributes datetime />" => array('time' => TRUE, 'datetime' => TRUE) + $allowed_global_attributes,
      "<code $global_attributes />" => array('code' => TRUE) + $allowed_global_attributes,
      "<var $global_attributes />" => array('var' => TRUE) + $allowed_global_attributes,
      "<samp $global_attributes />" => array('samp' => TRUE) + $allowed_global_attributes,
      "<kbd $global_attributes />" => array('kbd' => TRUE) + $allowed_global_attributes,
      "<sub $global_attributes />" => array('sub' => TRUE) + $allowed_global_attributes,
      "<sup $global_attributes />" => array('sup' => TRUE) + $allowed_global_attributes,
      "<i $global_attributes />" => array('i' => TRUE) + $allowed_global_attributes,
      "<b $global_attributes />" => array('b' => TRUE) + $allowed_global_attributes,
      "<u $global_attributes />" => array('u' => TRUE) + $allowed_global_attributes,
      "<mark $global_attributes />" => array('mark' => TRUE) + $allowed_global_attributes,
      "<ruby $global_attributes />" => array('ruby' => TRUE) + $allowed_global_attributes,
      "<rb $global_attributes />" => array('rb' => TRUE) + $allowed_global_attributes,
      "<rt $global_attributes />" => array('rt' => TRUE) + $allowed_global_attributes,
      "<rtc $global_attributes />" => array('rtc' => TRUE) + $allowed_global_attributes,
      "<rp $global_attributes />" => array('rp' => TRUE) + $allowed_global_attributes,
      "<bdi $global_attributes />" => array('bdi' => TRUE) + $allowed_global_attributes,
      "<bdo $global_attributes />" => array('bdo' => TRUE) + $allowed_global_attributes,
      "<span $global_attributes />" => array('span' => TRUE) + $allowed_global_attributes,
      "<br $global_attributes />" => array('br' => TRUE) + $allowed_global_attributes,
      "<wbr $global_attributes />" => array('wbr' => TRUE) + $allowed_global_attributes,

      /* Edits */
      "<ins $global_attributes cite datetime />" => array(
        'ins' => TRUE,
        'cite' => TRUE,
        'datetime' => TRUE,
      ) + $allowed_global_attributes,
      "<del $global_attributes cite datetime />" => array(
        'del' => TRUE,
        'cite' => TRUE,
        'datetime' => TRUE,
      ) + $allowed_global_attributes,

      /* Embedded content */
      "<img $global_attributes alt src crossorigin usemap ismap width height/>" => array(
        'img' => TRUE,
        'alt' => TRUE,
        'src' => TRUE,
        'crossorigin' => TRUE,
        'usemap' => TRUE,
        'ismap' => TRUE,
        'width' => TRUE,
        'height' => TRUE,
      ) + $allowed_global_attributes,
      "<iframe />" => array('iframe' => FALSE),
      "<embed />" => array('embed' => FALSE),
      "<object />" => array('object' => FALSE),
      "<param />" => array('param' => FALSE),
      "<video $global_attributes src crossorigin poster preload autoplay mediagroup loop muted controls width height />" => array(
        'video' => TRUE,
        'src' => TRUE,
        'crossorigin' => TRUE,
        'poster' => TRUE,
        'preload' => TRUE,
        'autoplay' => TRUE,
        'mediagroup' => TRUE,
        'loop' => TRUE,
        'muted' => TRUE,
        'controls' => TRUE,
        'width' => TRUE,
        'height' => TRUE,
      ) + $allowed_global_attributes,
      "<audio $global_attributes src crossorigin preload autoplay mediagroup loop muted controls />" => array(
        'audio' => TRUE,
        'src' => TRUE,
        'crossorigin' => TRUE,
        'preload' => TRUE,
        'autoplay' => TRUE,
        'mediagroup' => TRUE,
        'loop' => TRUE,
        'muted' => TRUE,
        'controls' => TRUE,
      ) + $allowed_global_attributes,
      "<source $global_attributes src type />" => array(
        'source' => TRUE,
        'src' => TRUE,
        'type' => TRUE,
      ) + $allowed_global_attributes,
      "<track $global_attributes kind src srclang label default />" => array(
        'track' => TRUE,
        'kind' => TRUE,
        'src' => TRUE,
        'srclang' => TRUE,
        'label' => TRUE,
        'default' => TRUE,
      ) + $allowed_global_attributes,
      "<map />" => array('map' => FALSE),
      "<area />" => array('area' => FALSE),

      /* Tabular data */
      "<table $global_attributes border sortable/>" => array(
        'table' => TRUE,
        'border' => TRUE,
        'sortable' => TRUE,
      ) + $allowed_global_attributes,
      "<caption $global_attributes />" => array(
        'caption' => TRUE,
      ) + $allowed_global_attributes,
      "<colgroup $global_attributes span />" => array(
        'colgroup' => TRUE,
        'span' => TRUE,
      ) + $allowed_global_attributes,
      "<col $global_attributes span />" => array(
        'col' => TRUE,
        'span' => TRUE,
      ) + $allowed_global_attributes,
      "<tbody $global_attributes />" => array(
        'tbody' => TRUE,
      ) + $allowed_global_attributes,
      "<thead $global_attributes />" => array(
        'thead' => TRUE,
      ) + $allowed_global_attributes,
      "<tfoot $global_attributes />" => array(
        'tfoot' => TRUE,
      ) + $allowed_global_attributes,
      "<tr $global_attributes />" => array(
        'tr' => TRUE,
      ) + $allowed_global_attributes,
      "<td $global_attributes colspan rowspan headers/>" => array(
        'td' => TRUE,
        'colspan' => TRUE,
        'rowspan' => TRUE,
        'headers' => TRUE,
      ) + $allowed_global_attributes,
      "<th $global_attributes colspan rowspan headers scope abbr sorted/>" => array(
        'th' => TRUE,
        'colspan' => TRUE,
        'rowspan' => TRUE,
        'headers' => TRUE,
        'scope' => TRUE,
        'abbr' => TRUE,
        'sorted' => TRUE,
      ) + $allowed_global_attributes,

      /* Forms */
      '<form />' => array('form' => FALSE),
      '<label />' => array('label' => FALSE),
      '<input />' => array('input' => FALSE),
      '<button />' => array('button' => FALSE),
      '<select />' => array('select' => FALSE),
      '<datalist />' => array('datalist' => FALSE),
      '<optgroup />' => array('optgroup' => FALSE),
      '<option />' => array('option' => FALSE),
      '<textarea />' => array('textarea' => FALSE),
      '<keygen />' => array('keygen' => FALSE),
      '<output />' => array('output' => FALSE),
      '<progress />' => array('progress' => FALSE),
      '<meter />' => array('meter' => FALSE),
      '<fieldset />' => array('fieldset' => FALSE),
      '<legend />' => array('legend' => FALSE),

      /* Scripting */
      '<script />' => array('script' => FALSE),
      '<noscript />' => array('noscript' => FALSE),
      '<template />' => array('template' => FALSE),
      '<canvas />' => array('canvas' => FALSE),

      /* Obsolete elements (https://www.w3.org/TR/html5-diff/#obsolete-elements) */
      '<basefont />' => array('basefont' => FALSE),
      '<big />' => array('big' => FALSE),
      '<center />' => array('center' => FALSE),
      '<font />' => array('font' => FALSE),
      '<strike />' => array('strike' => FALSE),
      '<tt />' => array('tt' => FALSE),
      '<frame />' => array('frame' => FALSE),
      '<frameset />' => array('frameset' => FALSE),
      '<noframes />' => array('noframes' => FALSE),
      '<acronym />' => array('acronym' => FALSE),
      '<applet />' => array('applet' => FALSE),
      '<isindex />' => array('isindex' => FALSE),
      '<dir />' => array('dir' => FALSE),

      /* Obsolete attributes (https://www.w3.org/TR/html5-diff/#obsolete-attributes) */
      '<a rev charset />' => array('rev' => FALSE, 'charset' => FALSE),
      '<link rev charset />' => array('rev' => FALSE, 'charset' => FALSE),
      '<a shape coords />' => array('shape' => FALSE, 'coords' => FALSE),
      '<iframe longdesc />' => array('longdesc' => FALSE),
      '<link target />' => array('target' => FALSE),
      '<area nohref />' => array('nohref' => FALSE),
      '<head profile />' => array('profile' => FALSE),
      '<html version />' => array('version' => FALSE),
      '<img name />' => array('name' => FALSE),
      '<meta scheme />' => array('scheme' => FALSE),
      '<object archive classid codebase codetype declare standby />' => array(
        'archive' => FALSE,
        'classid' => FALSE,
        'codebase' => FALSE,
        'codetype' => FALSE,
        'declare' => FALSE,
        'standby' => FALSE,
      ),
      '<param valuetype type />' => array(
        'valuetype' => FALSE,
        'type' => FALSE,
      ),
      '<td axis />' => array('axis' => FALSE),
      '<td axis />' => array('axis' => FALSE),
      '<td abbr scope />' => array('abbr' => FALSE, 'scope' => FALSE),
      '<table summary />' => array('summary' => FALSE),
      '<form accept />' => array('accept' => FALSE),
      '<input usemap />' => array('usemap' => FALSE),

      /* Presentational attributes */
      '<caption align />' => array('align' => FALSE),
      '<iframe align />' => array('align' => FALSE),
      '<img align />' => array('align' => FALSE),
      '<input align />' => array('align' => FALSE),
      '<object align />' => array('align' => FALSE),
      '<legend align />' => array('align' => FALSE),
      '<table align />' => array('align' => FALSE),
      '<hr align />' => array('align' => FALSE),
      '<div align />' => array('align' => FALSE),
      '<h1 align />' => array('align' => FALSE),
      '<h2 align />' => array('align' => FALSE),
      '<h3 align />' => array('align' => FALSE),
      '<h4 align />' => array('align' => FALSE),
      '<h5 align />' => array('align' => FALSE),
      '<h6 align />' => array('align' => FALSE),
      '<p align />' => array('align' => FALSE),
      '<col align />' => array('align' => FALSE),
      '<colgroup align />' => array('align' => FALSE),
      '<tbody align />' => array('align' => FALSE),
      '<td align />' => array('align' => FALSE),
      '<tfoot align />' => array('align' => FALSE),
      '<th align />' => array('align' => FALSE),
      '<thead align />' => array('align' => FALSE),
      '<tr align />' => array('align' => FALSE),
      '<body alink link text vlink />' => array(
        'alink' => FALSE,
        'link' => FALSE,
        'text' => FALSE,
        'vlink' => FALSE,
      ),
      '<body background />' => array('background' => FALSE),
      '<table bgcolor />' => array('bgcolor' => FALSE),
      '<tr bgcolor />' => array('bgcolor' => FALSE),
      '<td bgcolor />' => array('bgcolor' => FALSE),
      '<th bgcolor />' => array('bgcolor' => FALSE),
      '<body bgcolor />' => array('bgcolor' => FALSE),
      '<object border />' => array('border' => FALSE),
      '<table cellpadding cellspacing />' => array(
        'cellpadding' => FALSE,
        'cellspacing' => FALSE,
      ),
      '<col char charoff />' => array('char' => FALSE, 'charoff' => FALSE),
      '<colgroup char charoff />' => array('char' => FALSE, 'charoff' => FALSE),
      '<tbody char charoff />' => array('char' => FALSE, 'charoff' => FALSE),
      '<td char charoff />' => array('char' => FALSE, 'charoff' => FALSE),
      '<tfoot char charoff />' => array('char' => FALSE, 'charoff' => FALSE),
      '<th char charoff />' => array('char' => FALSE, 'charoff' => FALSE),
      '<thead char charoff />' => array('char' => FALSE, 'charoff' => FALSE),
      '<tr char charoff />' => array('char' => FALSE, 'charoff' => FALSE),
      '<br clear />' => array('clear' => FALSE),
      '<dl compact />' => array('compact' => FALSE),
      '<ol compact />' => array('compact' => FALSE),
      '<ul compact />' => array('compact' => FALSE),
      '<table frame />' => array('frame' => FALSE),
      '<iframe frameborder />' => array('frameborder' => FALSE),
      '<td height />' => array('height' => FALSE),
      '<th height />' => array('height' => FALSE),
      '<img hspace vspace />' => array('hspace' => FALSE, 'vspace' => FALSE),
      '<object hspace vspace />' => array('hspace' => FALSE, 'vspace' => FALSE),
      '<iframe marginheight marginwidth />' => array(
        'marginheight' => FALSE, 'marginwidth' => FALSE
      ),
      '<hr noshade />' => array('noshade' => FALSE),
      '<td nowrap />' => array('nowrap' => FALSE),
      '<th nowrap />' => array('nowrap' => FALSE),
      '<table rules />' => array('rules' => FALSE),
      '<iframe scrolling />' => array('scrolling' => FALSE),
      '<hr size />' => array('size' => FALSE),
      '<li type />' => array('type' => FALSE),
      '<ul type />' => array('type' => FALSE),
      '<col valign />' => array('valign' => FALSE),
      '<colgroup valign />' => array('valign' => FALSE),
      '<tbody valign />' => array('valign' => FALSE),
      '<td valign />' => array('valign' => FALSE),
      '<tfoot valign />' => array('valign' => FALSE),
      '<th valign />' => array('valign' => FALSE),
      '<thead valign />' => array('valign' => FALSE),
      '<tr valign />' => array('valign' => FALSE),
      '<hr width />' => array('width' => FALSE),
      '<table width />' => array('width' => FALSE),
      '<td width />' => array('width' => FALSE),
      '<th width />' => array('width' => FALSE),
      '<col width />' => array('width' => FALSE),
      '<colgroup width />' => array('width' => FALSE),
      '<pre width />' => array('width' => FALSE),
      '<img border />' => array('border' => FALSE),
      '<script language />' => array('language' => FALSE),
      '<a name />' => array('name' => TRUE),

      /* Bootstrap 3.0.2 classes */
      '<div class="navbar" />' => array('navbar' => TRUE),
      '<div class="caret" />' => array('caret' => TRUE),
      '<div class="label" />' => array('label' => TRUE),
      '<div class="table" />' => array('table' => TRUE),
      '<div class="img-responsive" />' => array('img-responsive' => TRUE),
      '<div class="img-rounded" />' => array('img-rounded' => TRUE),
      '<div class="img-thumbnail" />' => array('img-thumbnail' => TRUE),
      '<div class="img-circle" />' => array('img-circle' => TRUE),
      '<div class="sr-only" />' => array('sr-only' => TRUE),
      '<div class="lead" />' => array('lead' => TRUE),
      '<div class="text-muted" />' => array('text-muted' => TRUE),
      '<div class="text-primary" />' => array('text-primary' => TRUE),
      '<div class="text-warning" />' => array('text-warning' => TRUE),
      '<div class="text-danger" />' => array('text-danger' => TRUE),
      '<div class="text-success" />' => array('text-success' => TRUE),
      '<div class="text-info" />' => array('text-info' => TRUE),
      '<div class="text-left" />' => array('text-left' => TRUE),
      '<div class="text-right" />' => array('text-right' => TRUE),
      '<div class="text-center" />' => array('text-center' => TRUE),
      '<div class="h6" />' => array('h6' => TRUE),
      '<div class="h1" />' => array('h1' => TRUE),
      '<div class="h2" />' => array('h2' => TRUE),
      '<div class="h3" />' => array('h3' => TRUE),
      '<div class="h4" />' => array('h4' => TRUE),
      '<div class="h5" />' => array('h5' => TRUE),
      '<div class="page-header" />' => array('page-header' => TRUE),
      '<div class="list-unstyled" />' => array('list-unstyled' => TRUE),
      '<div class="list-inline" />' => array('list-inline' => TRUE),
      '<div class="initialism" />' => array('initialism' => TRUE),
      '<div class="pull-right" />' => array('pull-right' => TRUE),
      '<div class="prettyprint" />' => array('prettyprint' => TRUE),
      '<div class="pre-scrollable" />' => array('pre-scrollable' => TRUE),
      '<div class="container" />' => array('container' => TRUE),
      '<div class="row" />' => array('row' => TRUE),
      '<div class="col-lg-12" />' => array('col-lg-12' => TRUE),
      '<div class="col-xs-11" />' => array('col-xs-11' => TRUE),
      '<div class="col-xs-1" />' => array('col-xs-1' => TRUE),
      '<div class="col-xs-2" />' => array('col-xs-2' => TRUE),
      '<div class="col-xs-3" />' => array('col-xs-3' => TRUE),
      '<div class="col-xs-4" />' => array('col-xs-4' => TRUE),
      '<div class="col-xs-5" />' => array('col-xs-5' => TRUE),
      '<div class="col-xs-6" />' => array('col-xs-6' => TRUE),
      '<div class="col-xs-7" />' => array('col-xs-7' => TRUE),
      '<div class="col-xs-8" />' => array('col-xs-8' => TRUE),
      '<div class="col-xs-9" />' => array('col-xs-9' => TRUE),
      '<div class="col-xs-10" />' => array('col-xs-10' => TRUE),
      '<div class="col-xs-12" />' => array('col-xs-12' => TRUE),
      '<div class="col-sm-11" />' => array('col-sm-11' => TRUE),
      '<div class="col-sm-1" />' => array('col-sm-1' => TRUE),
      '<div class="col-sm-2" />' => array('col-sm-2' => TRUE),
      '<div class="col-sm-3" />' => array('col-sm-3' => TRUE),
      '<div class="col-sm-4" />' => array('col-sm-4' => TRUE),
      '<div class="col-sm-5" />' => array('col-sm-5' => TRUE),
      '<div class="col-sm-6" />' => array('col-sm-6' => TRUE),
      '<div class="col-sm-7" />' => array('col-sm-7' => TRUE),
      '<div class="col-sm-8" />' => array('col-sm-8' => TRUE),
      '<div class="col-sm-9" />' => array('col-sm-9' => TRUE),
      '<div class="col-sm-10" />' => array('col-sm-10' => TRUE),
      '<div class="col-sm-12" />' => array('col-sm-12' => TRUE),
      '<div class="col-sm-push-1" />' => array('col-sm-push-1' => TRUE),
      '<div class="col-sm-push-2" />' => array('col-sm-push-2' => TRUE),
      '<div class="col-sm-push-3" />' => array('col-sm-push-3' => TRUE),
      '<div class="col-sm-push-4" />' => array('col-sm-push-4' => TRUE),
      '<div class="col-sm-push-5" />' => array('col-sm-push-5' => TRUE),
      '<div class="col-sm-push-6" />' => array('col-sm-push-6' => TRUE),
      '<div class="col-sm-push-7" />' => array('col-sm-push-7' => TRUE),
      '<div class="col-sm-push-8" />' => array('col-sm-push-8' => TRUE),
      '<div class="col-sm-push-9" />' => array('col-sm-push-9' => TRUE),
      '<div class="col-sm-push-10" />' => array('col-sm-push-10' => TRUE),
      '<div class="col-sm-push-11" />' => array('col-sm-push-11' => TRUE),
      '<div class="col-sm-pull-1" />' => array('col-sm-pull-1' => TRUE),
      '<div class="col-sm-pull-2" />' => array('col-sm-pull-2' => TRUE),
      '<div class="col-sm-pull-3" />' => array('col-sm-pull-3' => TRUE),
      '<div class="col-sm-pull-4" />' => array('col-sm-pull-4' => TRUE),
      '<div class="col-sm-pull-5" />' => array('col-sm-pull-5' => TRUE),
      '<div class="col-sm-pull-6" />' => array('col-sm-pull-6' => TRUE),
      '<div class="col-sm-pull-7" />' => array('col-sm-pull-7' => TRUE),
      '<div class="col-sm-pull-8" />' => array('col-sm-pull-8' => TRUE),
      '<div class="col-sm-pull-9" />' => array('col-sm-pull-9' => TRUE),
      '<div class="col-sm-pull-10" />' => array('col-sm-pull-10' => TRUE),
      '<div class="col-sm-pull-11" />' => array('col-sm-pull-11' => TRUE),
      '<div class="col-sm-offset-1" />' => array('col-sm-offset-1' => TRUE),
      '<div class="col-sm-offset-2" />' => array('col-sm-offset-2' => TRUE),
      '<div class="col-sm-offset-3" />' => array('col-sm-offset-3' => TRUE),
      '<div class="col-sm-offset-4" />' => array('col-sm-offset-4' => TRUE),
      '<div class="col-sm-offset-5" />' => array('col-sm-offset-5' => TRUE),
      '<div class="col-sm-offset-6" />' => array('col-sm-offset-6' => TRUE),
      '<div class="col-sm-offset-7" />' => array('col-sm-offset-7' => TRUE),
      '<div class="col-sm-offset-8" />' => array('col-sm-offset-8' => TRUE),
      '<div class="col-sm-offset-9" />' => array('col-sm-offset-9' => TRUE),
      '<div class="col-sm-offset-10" />' => array('col-sm-offset-10' => TRUE),
      '<div class="col-sm-offset-11" />' => array('col-sm-offset-11' => TRUE),
      '<div class="col-md-11" />' => array('col-md-11' => TRUE),
      '<div class="col-md-1" />' => array('col-md-1' => TRUE),
      '<div class="col-md-2" />' => array('col-md-2' => TRUE),
      '<div class="col-md-3" />' => array('col-md-3' => TRUE),
      '<div class="col-md-4" />' => array('col-md-4' => TRUE),
      '<div class="col-md-5" />' => array('col-md-5' => TRUE),
      '<div class="col-md-6" />' => array('col-md-6' => TRUE),
      '<div class="col-md-7" />' => array('col-md-7' => TRUE),
      '<div class="col-md-8" />' => array('col-md-8' => TRUE),
      '<div class="col-md-9" />' => array('col-md-9' => TRUE),
      '<div class="col-md-10" />' => array('col-md-10' => TRUE),
      '<div class="col-md-12" />' => array('col-md-12' => TRUE),
      '<div class="col-md-push-0" />' => array('col-md-push-0' => TRUE),
      '<div class="col-md-push-1" />' => array('col-md-push-1' => TRUE),
      '<div class="col-md-push-2" />' => array('col-md-push-2' => TRUE),
      '<div class="col-md-push-3" />' => array('col-md-push-3' => TRUE),
      '<div class="col-md-push-4" />' => array('col-md-push-4' => TRUE),
      '<div class="col-md-push-5" />' => array('col-md-push-5' => TRUE),
      '<div class="col-md-push-6" />' => array('col-md-push-6' => TRUE),
      '<div class="col-md-push-7" />' => array('col-md-push-7' => TRUE),
      '<div class="col-md-push-8" />' => array('col-md-push-8' => TRUE),
      '<div class="col-md-push-9" />' => array('col-md-push-9' => TRUE),
      '<div class="col-md-push-10" />' => array('col-md-push-10' => TRUE),
      '<div class="col-md-push-11" />' => array('col-md-push-11' => TRUE),
      '<div class="col-md-pull-0" />' => array('col-md-pull-0' => TRUE),
      '<div class="col-md-pull-1" />' => array('col-md-pull-1' => TRUE),
      '<div class="col-md-pull-2" />' => array('col-md-pull-2' => TRUE),
      '<div class="col-md-pull-3" />' => array('col-md-pull-3' => TRUE),
      '<div class="col-md-pull-4" />' => array('col-md-pull-4' => TRUE),
      '<div class="col-md-pull-5" />' => array('col-md-pull-5' => TRUE),
      '<div class="col-md-pull-6" />' => array('col-md-pull-6' => TRUE),
      '<div class="col-md-pull-7" />' => array('col-md-pull-7' => TRUE),
      '<div class="col-md-pull-8" />' => array('col-md-pull-8' => TRUE),
      '<div class="col-md-pull-9" />' => array('col-md-pull-9' => TRUE),
      '<div class="col-md-pull-10" />' => array('col-md-pull-10' => TRUE),
      '<div class="col-md-pull-11" />' => array('col-md-pull-11' => TRUE),
      '<div class="col-md-offset-0" />' => array('col-md-offset-0' => TRUE),
      '<div class="col-md-offset-1" />' => array('col-md-offset-1' => TRUE),
      '<div class="col-md-offset-2" />' => array('col-md-offset-2' => TRUE),
      '<div class="col-md-offset-3" />' => array('col-md-offset-3' => TRUE),
      '<div class="col-md-offset-4" />' => array('col-md-offset-4' => TRUE),
      '<div class="col-md-offset-5" />' => array('col-md-offset-5' => TRUE),
      '<div class="col-md-offset-6" />' => array('col-md-offset-6' => TRUE),
      '<div class="col-md-offset-7" />' => array('col-md-offset-7' => TRUE),
      '<div class="col-md-offset-8" />' => array('col-md-offset-8' => TRUE),
      '<div class="col-md-offset-9" />' => array('col-md-offset-9' => TRUE),
      '<div class="col-md-offset-10" />' => array('col-md-offset-10' => TRUE),
      '<div class="col-md-offset-11" />' => array('col-md-offset-11' => TRUE),
      '<div class="col-lg-11" />' => array('col-lg-11' => TRUE),
      '<div class="col-lg-1" />' => array('col-lg-1' => TRUE),
      '<div class="col-lg-2" />' => array('col-lg-2' => TRUE),
      '<div class="col-lg-3" />' => array('col-lg-3' => TRUE),
      '<div class="col-lg-4" />' => array('col-lg-4' => TRUE),
      '<div class="col-lg-5" />' => array('col-lg-5' => TRUE),
      '<div class="col-lg-6" />' => array('col-lg-6' => TRUE),
      '<div class="col-lg-7" />' => array('col-lg-7' => TRUE),
      '<div class="col-lg-8" />' => array('col-lg-8' => TRUE),
      '<div class="col-lg-9" />' => array('col-lg-9' => TRUE),
      '<div class="col-lg-10" />' => array('col-lg-10' => TRUE),
      '<div class="col-lg-push-0" />' => array('col-lg-push-0' => TRUE),
      '<div class="col-lg-push-1" />' => array('col-lg-push-1' => TRUE),
      '<div class="col-lg-push-2" />' => array('col-lg-push-2' => TRUE),
      '<div class="col-lg-push-3" />' => array('col-lg-push-3' => TRUE),
      '<div class="col-lg-push-4" />' => array('col-lg-push-4' => TRUE),
      '<div class="col-lg-push-5" />' => array('col-lg-push-5' => TRUE),
      '<div class="col-lg-push-6" />' => array('col-lg-push-6' => TRUE),
      '<div class="col-lg-push-7" />' => array('col-lg-push-7' => TRUE),
      '<div class="col-lg-push-8" />' => array('col-lg-push-8' => TRUE),
      '<div class="col-lg-push-9" />' => array('col-lg-push-9' => TRUE),
      '<div class="col-lg-push-10" />' => array('col-lg-push-10' => TRUE),
      '<div class="col-lg-push-11" />' => array('col-lg-push-11' => TRUE),
      '<div class="col-lg-pull-0" />' => array('col-lg-pull-0' => TRUE),
      '<div class="col-lg-pull-1" />' => array('col-lg-pull-1' => TRUE),
      '<div class="col-lg-pull-2" />' => array('col-lg-pull-2' => TRUE),
      '<div class="col-lg-pull-3" />' => array('col-lg-pull-3' => TRUE),
      '<div class="col-lg-pull-4" />' => array('col-lg-pull-4' => TRUE),
      '<div class="col-lg-pull-5" />' => array('col-lg-pull-5' => TRUE),
      '<div class="col-lg-pull-6" />' => array('col-lg-pull-6' => TRUE),
      '<div class="col-lg-pull-7" />' => array('col-lg-pull-7' => TRUE),
      '<div class="col-lg-pull-8" />' => array('col-lg-pull-8' => TRUE),
      '<div class="col-lg-pull-9" />' => array('col-lg-pull-9' => TRUE),
      '<div class="col-lg-pull-10" />' => array('col-lg-pull-10' => TRUE),
      '<div class="col-lg-pull-11" />' => array('col-lg-pull-11' => TRUE),
      '<div class="col-lg-offset-0" />' => array('col-lg-offset-0' => TRUE),
      '<div class="col-lg-offset-1" />' => array('col-lg-offset-1' => TRUE),
      '<div class="col-lg-offset-2" />' => array('col-lg-offset-2' => TRUE),
      '<div class="col-lg-offset-3" />' => array('col-lg-offset-3' => TRUE),
      '<div class="col-lg-offset-4" />' => array('col-lg-offset-4' => TRUE),
      '<div class="col-lg-offset-5" />' => array('col-lg-offset-5' => TRUE),
      '<div class="col-lg-offset-6" />' => array('col-lg-offset-6' => TRUE),
      '<div class="col-lg-offset-7" />' => array('col-lg-offset-7' => TRUE),
      '<div class="col-lg-offset-8" />' => array('col-lg-offset-8' => TRUE),
      '<div class="col-lg-offset-9" />' => array('col-lg-offset-9' => TRUE),
      '<div class="col-lg-offset-10" />' => array('col-lg-offset-10' => TRUE),
      '<div class="col-lg-offset-11" />' => array('col-lg-offset-11' => TRUE),
      '<div class="table-bordered" />' => array('table-bordered' => TRUE),
      '<div class="table-responsive" />' => array('table-responsive' => TRUE),
      '<div class="form-control" />' => array('form-control' => TRUE),
      '<div class="form-group" />' => array('form-group' => TRUE),
      '<div class="checkbox" />' => array('checkbox' => TRUE),
      '<div class="checkbox-inline" />' => array('checkbox-inline' => TRUE),
      '<div class="input-sm" />' => array('input-sm' => TRUE),
      '<div class="input-lg" />' => array('input-lg' => TRUE),
      '<div class="control-label" />' => array('control-label' => TRUE),
      '<div class="input-group-addon" />' => array('input-group-addon' => TRUE),
      '<div class="form-control-static" />' => array('form-control-static' => TRUE),
      '<div class="help-block" />' => array('help-block' => TRUE),
      '<div class="btn" />' => array('btn' => TRUE),
      '<div class="active" />' => array('active' => TRUE),
      '<div class="btn-default" />' => array('btn-default' => TRUE),
      '<div class="btn-primary" />' => array('btn-primary' => TRUE),
      '<div class="btn-warning" />' => array('btn-warning' => TRUE),
      '<div class="btn-danger" />' => array('btn-danger' => TRUE),
      '<div class="btn-success" />' => array('btn-success' => TRUE),
      '<div class="btn-info" />' => array('btn-info' => TRUE),
      '<div class="btn-link" />' => array('btn-link' => TRUE),
      '<div class="btn-lg" />' => array('btn-lg' => TRUE),
      '<div class="btn-xs" />' => array('btn-xs' => TRUE),
      '<div class="btn-block" />' => array('btn-block' => TRUE),
      '<div class="fade" />' => array('fade' => TRUE),
      '<div class="in" />' => array('in' => TRUE),
      '<div class="collapse" />' => array('collapse' => TRUE),
      '<div class="collapsing" />' => array('collapsing' => TRUE),
      '<div class="glyphicon" />' => array('glyphicon' => TRUE),
      '<div class="dropdown" />' => array('dropdown' => TRUE),
      '<div class="dropdown-menu" />' => array('dropdown-menu' => TRUE),
      '<div class="divider" />' => array('divider' => TRUE),
      '<div class="dropdown-header" />' => array('dropdown-header' => TRUE),
      '<div class="dropdown-backdrop" />' => array('dropdown-backdrop' => TRUE),
      '<div class="btn-group-vertical" />' => array('btn-group-vertical' => TRUE),
      '<div class="btn-group" />' => array('btn-group' => TRUE),
      '<div class="dropdown-toggle" />' => array('dropdown-toggle' => TRUE),
      '<div class="btn-group-justified" />' => array('btn-group-justified' => TRUE),
      '<div class="input-group" />' => array('input-group' => TRUE),
      '<div class="col" />' => array('col' => TRUE),
      '<div class="input-group-btn" />' => array('input-group-btn' => TRUE),
      '<div class="nav" />' => array('nav' => TRUE),
      '<div class="nav-divider" />' => array('nav-divider' => TRUE),
      '<div class="nav-tabs" />' => array('nav-tabs' => TRUE),
      '<div class="nav-justified" />' => array('nav-justified' => TRUE),
      '<div class="nav-tabs-justified" />' => array('nav-tabs-justified' => TRUE),
      '<div class="pill-pane" />' => array('pill-pane' => TRUE),
      '<div class="navbar-header" />' => array('navbar-header' => TRUE),
      '<div class="navbar-collapse" />' => array('navbar-collapse' => TRUE),
      '<div class="navbar-static-top" />' => array('navbar-static-top' => TRUE),
      '<div class="navbar-fixed-bottom" />' => array('navbar-fixed-bottom' => TRUE),
      '<div class="navbar-fixed-top" />' => array('navbar-fixed-top' => TRUE),
      '<div class="navbar-brand" />' => array('navbar-brand' => TRUE),
      '<div class="navbar-toggle" />' => array('navbar-toggle' => TRUE),
      '<div class="icon-bar" />' => array('icon-bar' => TRUE),
      '<div class="navbar-nav" />' => array('navbar-nav' => TRUE),
      '<div class="navbar-left" />' => array('navbar-left' => TRUE),
      '<div class="navbar-right" />' => array('navbar-right' => TRUE),
      '<div class="navbar-form" />' => array('navbar-form' => TRUE),
      '<div class="navbar-btn" />' => array('navbar-btn' => TRUE),
      '<div class="navbar-text" />' => array('navbar-text' => TRUE),
      '<div class="navbar-default" />' => array('navbar-default' => TRUE),
      '<div class="navbar-link" />' => array('navbar-link' => TRUE),
      '<div class="navbar-inverse" />' => array('navbar-inverse' => TRUE),
      '<div class="breadcrumb" />' => array('breadcrumb' => TRUE),
      '<div class="pagination" />' => array('pagination' => TRUE),
      '<div class="pager" />' => array('pager' => TRUE),
      '<div class="label-default" />' => array('label-default' => TRUE),
      '<div class="label-primary" />' => array('label-primary' => TRUE),
      '<div class="label-success" />' => array('label-success' => TRUE),
      '<div class="label-info" />' => array('label-info' => TRUE),
      '<div class="label-warning" />' => array('label-warning' => TRUE),
      '<div class="label-danger" />' => array('label-danger' => TRUE),
      '<div class="badge" />' => array('badge' => TRUE),
      '<div class="jumbotron" />' => array('jumbotron' => TRUE),
      '<div class="thumbnail" />' => array('thumbnail' => TRUE),
      '<div class="caption" />' => array('caption' => TRUE),
      '<div class="alert" />' => array('alert' => TRUE),
      '<div class="alert-link" />' => array('alert-link' => TRUE),
      '<div class="alert-dismissable" />' => array('alert-dismissable' => TRUE),
      '<div class="close" />' => array('close' => TRUE),
      '<div class="alert-success" />' => array('alert-success' => TRUE),
      '<div class="alert-info" />' => array('alert-info' => TRUE),
      '<div class="alert-warning" />' => array('alert-warning' => TRUE),
      '<div class="alert-danger" />' => array('alert-danger' => TRUE),
      '<div class="progress" />' => array('progress' => TRUE),
      '<div class="progress-bar" />' => array('progress-bar' => TRUE),
      '<div class="progress-bar-success" />' => array('progress-bar-success' => TRUE),
      '<div class="progress-bar-info" />' => array('progress-bar-info' => TRUE),
      '<div class="progress-bar-warning" />' => array('progress-bar-warning' => TRUE),
      '<div class="progress-bar-danger" />' => array('progress-bar-danger' => TRUE),
      '<div class="media-body" />' => array('media-body' => TRUE),
      '<div class="media" />' => array('media' => TRUE),
      '<div class="media-object" />' => array('media-object' => TRUE),
      '<div class="media-heading" />' => array('media-heading' => TRUE),
      '<div class="pull-left" />' => array('pull-left' => TRUE),
      '<div class="media-list" />' => array('media-list' => TRUE),
      '<div class="list-group" />' => array('list-group' => TRUE),
      '<div class="list-group-item" />' => array('list-group-item' => TRUE),
      '<div class="list-group-item-heading" />' => array('list-group-item-heading' => TRUE),
      '<div class="list-group-item-text" />' => array('list-group-item-text' => TRUE),
      '<div class="panel" />' => array('panel' => TRUE),
      '<div class="panel-body" />' => array('panel-body' => TRUE),
      '<div class="panel-heading" />' => array('panel-heading' => TRUE),
      '<div class="panel-title" />' => array('panel-title' => TRUE),
      '<div class="panel-footer" />' => array('panel-footer' => TRUE),
      '<div class="panel-default" />' => array('panel-default' => TRUE),
      '<div class="panel-primary" />' => array('panel-primary' => TRUE),
      '<div class="panel-success" />' => array('panel-success' => TRUE),
      '<div class="panel-warning" />' => array('panel-warning' => TRUE),
      '<div class="panel-danger" />' => array('panel-danger' => TRUE),
      '<div class="panel-info" />' => array('panel-info' => TRUE),
      '<div class="well" />' => array('well' => TRUE),
      '<div class="well-lg" />' => array('well-lg' => TRUE),
      '<div class="well-sm" />' => array('well-sm' => TRUE),
      '<div class="modal-open" />' => array('modal-open' => TRUE),
      '<div class="modal" />' => array('modal' => TRUE),
      '<div class="modal-dialog" />' => array('modal-dialog' => TRUE),
      '<div class="modal-content" />' => array('modal-content' => TRUE),
      '<div class="modal-backdrop" />' => array('modal-backdrop' => TRUE),
      '<div class="modal-header" />' => array('modal-header' => TRUE),
      '<div class="modal-title" />' => array('modal-title' => TRUE),
      '<div class="modal-body" />' => array('modal-body' => TRUE),
      '<div class="modal-footer" />' => array('modal-footer' => TRUE),
      '<div class="tooltip" />' => array('tooltip' => TRUE),
      '<div class="top" />' => array('top' => TRUE),
      '<div class="right" />' => array('right' => TRUE),
      '<div class="bottom" />' => array('bottom' => TRUE),
      '<div class="left" />' => array('left' => TRUE),
      '<div class="tooltip-inner" />' => array('tooltip-inner' => TRUE),
      '<div class="tooltip-arrow" />' => array('tooltip-arrow' => TRUE),
      '<div class="popover" />' => array('popover' => TRUE),
      '<div class="popover-title" />' => array('popover-title' => TRUE),
      '<div class="popover-content" />' => array('popover-content' => TRUE),
      '<div class="arrow" />' => array('arrow' => TRUE),
      '<div class="carousel" />' => array('carousel' => TRUE),
      '<div class="carousel-inner" />' => array('carousel-inner' => TRUE),
      '<div class="item" />' => array('item' => TRUE),
      '<div class="prev" />' => array('prev' => TRUE),
      '<div class="next" />' => array('next' => TRUE),
      '<div class="carousel-control" />' => array('carousel-control' => TRUE),
      '<div class="glyphicon-chevron-right" />' => array('glyphicon-chevron-right' => TRUE),
      '<div class="icon-next" />' => array('icon-next' => TRUE),
      '<div class="carousel-indicators" />' => array('carousel-indicators' => TRUE),
      '<div class="carousel-caption" />' => array('carousel-caption' => TRUE),
      '<div class="hide" />' => array('hide' => TRUE),
      '<div class="show" />' => array('show' => TRUE),
      '<div class="invisible" />' => array('invisible' => TRUE),
      '<div class="text-hide" />' => array('text-hide' => TRUE),
      '<div class="affix" />' => array('affix' => TRUE),
      '<div class="hidden" />' => array('hidden' => TRUE),
      '<div class="visible-xs" />' => array('visible-xs' => TRUE),
      '<div class="visible-sm" />' => array('visible-sm' => TRUE),
      '<div class="visible-md" />' => array('visible-md' => TRUE),
      '<div class="visible-lg" />' => array('visible-lg' => TRUE),
      '<div class="hidden-xs" />' => array('hidden-xs' => TRUE),
      '<div class="hidden-sm" />' => array('hidden-sm' => TRUE),
      '<div class="hidden-md" />' => array('hidden-md' => TRUE),
      '<div class="hidden-lg" />' => array('hidden-lg' => TRUE),
      '<div class="visible-print" />' => array('visible-print' => TRUE),
      '<div class="hidden-print" />' => array('hidden-print' => TRUE),
    );
    $this->assertFilteredString($filter, $tests);
  }

  /*
   * Modify global array to allow ID in certain circumstances
   */
  function allow_id($global_attributes) {
    $global_attributes['id='] = TRUE;
    return $global_attributes;
  }

  /** Copied from filter.test */
  function assertFilteredString($filter, $tests) {
    foreach ($tests as $source => $tasks) {
      $result = check_markup($source, $filter);
      foreach ($tasks as $value => $is_expected) {
        // Not using assertIdentical, since combination with strpos() is hard to grok.
        if ($is_expected) {
          $success = $this->assertTrue(strpos($result, $value) !== FALSE, format_string('@source: @value found.', array(
            '@source' => var_export($source, TRUE),
            '@value' => var_export($value, TRUE),
          )));
        }
        else {
          $success = $this->assertTrue(strpos($result, $value) === FALSE, format_string('@source: @value not found.', array
(
            '@source' => var_export($source, TRUE),
            '@value' => var_export($value, TRUE),
          )));
        }
        if (!$success) {
          $this->verbose('Source:<pre>' . check_plain(var_export($source, TRUE)) . '</pre>'
            . '<hr />' . 'Result:<pre>' . check_plain(var_export($result, TRUE)) . '</pre>'
            . '<hr />' . ($is_expected ? 'Expected:' : 'Not expected:')
            . '<pre>' . check_plain(var_export($value, TRUE)) . '</pre>'
          );
        }
      }
    }
  }

}
